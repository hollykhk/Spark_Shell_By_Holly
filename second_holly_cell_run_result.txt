+-----+------------+---+------+------+-------+------------+---------+------+-----+------+---------+--------------------+
|  mpg|displacement| hp|torque|CRatio|RARatio|CarbBarrells|NoOfSpeed|length|width|weight|automatic|            features|
+-----+------------+---+------+------+-------+------------+---------+------+-----+------+---------+--------------------+
| 18.9|       350.0|165|   260|   8.0|   2.56|           4|        3| 200.3| 69.9|  3910|        1|[350.0,165.0,260....|
| 17.0|       350.0|170|   275|   8.5|   2.56|           4|        3| 199.6| 72.9|  3860|        1|[350.0,170.0,275....|
| 20.0|       250.0|105|   185|  8.25|   2.73|           1|        3| 196.7| 72.2|  3510|        1|[250.0,105.0,185....|
|18.25|       351.0|143|   255|   8.0|    3.0|           2|        3| 199.9| 74.0|  3890|        1|[351.0,143.0,255....|
|20.07|       225.0| 95|   170|   8.4|   2.76|           1|        3| 194.1| 71.8|  3365|        0|[225.0,95.0,170.0...|
| 11.2|       440.0|215|   330|   8.2|   2.88|           4|        3| 184.5| 69.0|  4215|        1|[440.0,215.0,330....|
|22.12|       231.0|110|   175|   8.0|   2.56|           2|        3| 179.3| 65.4|  3020|        1|[231.0,110.0,175....|
|21.47|       262.0|110|   200|   8.5|   2.56|           2|        3| 179.3| 65.4|  3180|        1|[262.0,110.0,200....|
| 34.7|        89.7| 70|    81|   8.2|    3.9|           2|        4| 155.7| 64.0|  1905|        0|[89.7,70.0,81.0,8...|
| 30.4|        96.9| 75|    83|   9.0|    4.3|           2|        5| 165.2| 65.0|  2320|        0|[96.9,75.0,83.0,9...|
| 16.5|       350.0|155|   250|   8.5|   3.08|           4|        3| 195.4| 74.4|  3885|        1|[350.0,155.0,250....|
| 36.5|        85.3| 80|    83|   8.5|   3.89|           2|        4| 160.6| 62.2|  2009|        0|[85.3,80.0,83.0,8...|
| 21.5|       171.0|109|   146|   8.2|   3.22|           2|        4| 170.4| 66.9|  2655|        0|[171.0,109.0,146....|
| 19.7|       258.0|110|   195|   8.0|   3.08|           1|        3| 171.5| 77.0|  3375|        1|[258.0,110.0,195....|
| 20.3|       140.0| 83|   109|   8.4|    3.4|           2|        4| 168.8| 69.4|  2700|        0|[140.0,83.0,109.0...|
| 17.8|       302.0|129|   220|   8.0|    3.0|           2|        3| 199.9| 74.0|  3890|        1|[302.0,129.0,220....|
|14.39|       500.0|190|   360|   8.5|   2.73|           4|        3| 224.1| 79.8|  5290|        1|[500.0,190.0,360....|
|14.89|       440.0|215|   330|   8.2|   2.71|           4|        3| 231.0| 79.7|  5185|        1|[440.0,215.0,330....|
| 17.8|       350.0|155|   250|   8.5|   3.08|           4|        3| 196.7| 72.2|  3910|        1|[350.0,155.0,250....|
|16.41|       318.0|145|   255|   8.5|   2.45|           2|        3| 197.6| 71.0|  3660|        1|[318.0,145.0,255....|
|23.54|       231.0|110|   175|   8.0|   2.56|           2|        3| 179.3| 65.4|  3050|        1|[231.0,110.0,175....|
|21.47|       360.0|180|   290|   8.4|   2.45|           2|        3| 214.2| 76.3|  4250|        1|[360.0,180.0,290....|
| 31.9|        96.9| 75|    83|   9.0|    4.3|           2|        5| 165.2| 61.8|  2275|        0|[96.9,75.0,83.0,9...|
|13.27|       460.0|223|   366|   8.0|    3.0|           4|        3| 228.0| 79.8|  5430|        1|[460.0,223.0,366....|
| 23.9|       133.6| 96|   120|   8.4|   3.91|           2|        5| 171.5| 63.4|  2535|        0|[133.6,96.0,120.0...|
|19.73|       318.0|140|   255|   8.5|   2.71|           2|        3| 215.3| 76.3|  4370|        1|[318.0,140.0,255....|
| 13.9|       351.0|148|   243|   8.0|   3.25|           2|        3| 215.5| 78.5|  4540|        1|[351.0,148.0,243....|
|13.27|       351.0|148|   243|   8.0|   3.26|           2|        3| 216.1| 78.5|  4715|        1|[351.0,148.0,243....|
|13.77|       360.0|195|   295|  8.25|   3.15|           4|        3| 209.3| 77.4|  4215|        1|[360.0,195.0,295....|
| 16.5|       360.0|165|   255|   8.5|   2.73|           4|        3| 185.2| 69.0|  3660|        1|[360.0,165.0,255....|
+-----+------------+---+------+------+-------+------------+---------+------+-----+------+---------+--------------------+

+-----+------------+---+------+------+-------+------------+---------+------+-----+------+---------+--------------------+
|  mpg|displacement| hp|torque|CRatio|RARatio|CarbBarrells|NoOfSpeed|length|width|weight|automatic|            features|
+-----+------------+---+------+------+-------+------------+---------+------+-----+------+---------+--------------------+
| 11.2|       440.0|215|   330|   8.2|   2.88|           4|        3| 184.5| 69.0|  4215|        1|[440.0,215.0,330....|
|14.39|       500.0|190|   360|   8.5|   2.73|           4|        3| 224.1| 79.8|  5290|        1|[500.0,190.0,360....|
|14.89|       440.0|215|   330|   8.2|   2.71|           4|        3| 231.0| 79.7|  5185|        1|[440.0,215.0,330....|
|21.47|       360.0|180|   290|   8.4|   2.45|           2|        3| 214.2| 76.3|  4250|        1|[360.0,180.0,290....|
|13.27|       460.0|223|   366|   8.0|    3.0|           4|        3| 228.0| 79.8|  5430|        1|[460.0,223.0,366....|
|19.73|       318.0|140|   255|   8.5|   2.71|           2|        3| 215.3| 76.3|  4370|        1|[318.0,140.0,255....|
| 13.9|       351.0|148|   243|   8.0|   3.25|           2|        3| 215.5| 78.5|  4540|        1|[351.0,148.0,243....|
|13.27|       351.0|148|   243|   8.0|   3.26|           2|        3| 216.1| 78.5|  4715|        1|[351.0,148.0,243....|
|13.77|       360.0|195|   295|  8.25|   3.15|           4|        3| 209.3| 77.4|  4215|        1|[360.0,195.0,295....|
+-----+------------+---+------+------+-------+------------+---------+------+-----+------+---------+--------------------+

Train = 21 Test = 9
Coefficients: [0.0,-0.007017141998245329,0.0,0.0,2.9424064428541645,0.0,-0.8628157004496956,0.0,-0.26534908526629886,-0.004729717739392178,0.0] Intercept: 50.05862655261031
numIterations: 101
Iteration Summary History: List(0.4999999999999991, 0.39843747544896296, 0.1482295744826868, 0.14005807692077016, 0.1446968308765583, 0.12669217682960035, 0.1258630122249318, 0.12511340526765194, 0.12322427437191928, 0.12276798916627535, 0.12223083208160618, 0.12198963359328388, 0.1217980834932178, 0.12150878758627376, 0.1213259562375511, 0.12091301876948132, 0.12028626315701765, 0.12005169278210738, 0.11977289314390564, 0.1194232265949696, 0.11834850015514281, 0.1181617248486041, 0.11798849972869874, 0.1177544183274557, 0.11764132783918399, 0.11761053226921289, 0.1175372291362528, 0.11740134195406475, 0.11730833333681416, 0.11717018963534281, 0.11717255191139506, 0.11715818488156707, 0.11713935699462788, 0.1171267413739083, 0.11711722997357507, 0.11710097506014061, 0.11710017828208376, 0.11709947582555068, 0.11709917904474389, 0.11709768838483264, 0.1170929119008887, 0.11708390851967115, 0.11707212479832396, 0.1170662760037003, 0.11706127166256519, 0.1170522477334453, 0.11704956881759424, 0.11704258835326761, 0.11703425632000736, 0.11703156832900255, 0.11702939448133705, 0.1170287537028389, 0.11702848337455823, 0.11702624620585331, 0.11702621917586575, 0.11702618327298192, 0.11702613294793285, 0.11702611993473151, 0.11702611478925005, 0.11702610986218365, 0.1170260926507051, 0.11702609220245044, 0.11702609164365266, 0.11702609140604611, 0.11702609131291232, 0.11702609126614305, 0.11702609123924826, 0.11702609122479349, 0.11702609121648369, 0.11702609118295512, 0.11702609115548301, 0.11702609114831418, 0.11702609112982439, 0.11702609111569616, 0.11702609110533795, 0.11702609107307879, 0.11702609106553438, 0.11702609104277378, 0.11702609103254892, 0.11702609102831152, 0.11702609102006481, 0.1170260910096031, 0.11702609100701458, 0.11702609100499353, 0.11702609100337794, 0.11702609100260936, 0.11702609100161605, 0.11702609099996845, 0.11702609099909858, 0.11702609099704782, 0.11702609099464559, 0.11702609099325104, 0.11702609099095895, 0.11702609099070427, 0.11702609099051453, 0.11702609099025423, 0.1170260909899599, 0.11702609098981817, 0.1170260909895432, 0.11702609098949088, 0.11702609098940772)
+--------------------+
|           residuals|
+--------------------+
|   2.096185905880297|
|  0.7908329847008133|
|  0.9933640910559873|
|   0.990486841867046|
| 0.11297177146952109|
|-0.47327657578057725|
| -0.3665217374778287|
|    3.10090481251963|
|  0.7500255929329356|
| -0.8282089241727775|
|    5.01476258834807|
|  -3.507789616591573|
|   0.333771260508545|
| -4.5436584568213085|
|  0.4422468538916142|
|0.006266031726166688|
| -1.1010376664257713|
|  1.0886149564011873|
|    1.18807122180813|
| -3.8627451348475503|
+--------------------+
only showing top 20 rows

RMSE: 2.185539052409796
r2: 0.864032450749066
+-----+------------+---+------+------+-------+------------+---------+------+-----+------+---------+--------------------+------------------+
|  mpg|displacement| hp|torque|CRatio|RARatio|CarbBarrells|NoOfSpeed|length|width|weight|automatic|            features|        prediction|
+-----+------------+---+------+------+-------+------------+---------+------+-----+------+---------+--------------------+------------------+
| 11.2|       440.0|215|   330|   8.2|   2.88|           4|        3| 184.5| 69.0|  4215|        1|[440.0,215.0,330....|16.190777322145827|
|14.39|       500.0|190|   360|   8.5|   2.73|           4|        3| 224.1| 79.8|  5290|        1|[500.0,190.0,360....| 7.974628214951217|
|14.89|       440.0|215|   330|   8.2|   2.71|           4|        3| 231.0| 79.7|  5185|        1|[440.0,215.0,330....| 8.263506807300807|
|21.47|       360.0|180|   290|   8.4|   2.45|           2|        3| 214.2| 76.3|  4250|        1|[360.0,180.0,290....|13.068554078334408|
|13.27|       460.0|223|   366|   8.0|    3.0|           4|        3| 228.0| 79.8|  5430|        1|[460.0,223.0,366....| 7.875351785064844|
|19.73|       318.0|140|   255|   8.5|   2.71|           2|        3| 215.3| 76.3|  4370|        1|[318.0,140.0,255....|13.546699304679244|
| 13.9|       351.0|148|   243|   8.0|   3.25|           2|        3| 215.5| 78.5|  4540|        1|[351.0,148.0,243....|13.691641644552007|
|13.27|       351.0|148|   243|   8.0|   3.26|           2|        3| 216.1| 78.5|  4715|        1|[351.0,148.0,243....|12.893365104586913|
|13.77|       360.0|195|   295|  8.25|   3.15|           4|        3| 209.3| 77.4|  4215|        1|[360.0,195.0,295....|14.896637585444445|
+-----+------------+---+------+------+-------+------------+---------+------+-----+------+---------+--------------------+------------------+

Root Mean Squared Error =  5.264
Mean Squared Error = 27.706
** That's All Folks **
import org.apache.spark.sql.SparkSession
import org.apache.spark.sql.functions.corr
import org.apache.spark.ml.regression.LinearRegression
import org.apache.spark.ml.feature.VectorAssembler
import org.apache.spark.ml.linalg.Vectors
import org.apache.spark.ml.evaluation.RegressionEvaluator
filePath: String = /FileStore/tables/o1q3k3531491165543800/car_milage-6f50d.csv
cars: org.apache.spark.sql.DataFrame = [mpg: double, displacement: double ... 10 more fields]
cars1: org.apache.spark.sql.DataFrame = [mpg: double, displacement: double ... 10 more fields]
assembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_91645462844e
cars2: org.apache.spark.sql.DataFrame = [mpg: double, displacement: double ... 11 more fields]
train: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [mpg: double, displacement: double ... 11 more fields]
test: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [mpg: double, displacement: double ... 11 more fields]
algLR: org.apache.spark.ml.regression.LinearRegression = linReg_c82d1a720ff8
mdlLR: org.apache.spark.ml.regression.LinearRegressionModel = linReg_c82d1a720ff8
trSummary: org.apache.spark.ml.regression.LinearRegressionTrainingSummary = org.apache.spark.ml.regression.LinearRegressionTrainingSummary@1613e6b6
predictions: org.apache.spark.sql.DataFrame = [mpg: double, displacement: double ... 12 more fields]
evaluator: org.apache.spark.ml.evaluation.RegressionEvaluator = regEval_9a7ee110fd81
rmse: Double = 5.263602222142872
mse: Double = 27.705508352947376
